---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import ImageCaption from '../../components/ImageCaption.astro';
import Page from '../../layouts/Page.astro';
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
    const works = await getCollection('portfolio');
    const activeWorks = works.filter((work) => work.data.active);
    const n = activeWorks.length;
    return activeWorks.map((painting, index) => {
        const nextIndex = (index + 1) % n;
        const next = `/portfolio/${works[nextIndex].id}`;
        const prevIndex = index - 1 < 0 ? n - 1 : index - 1;
        const previous = `/portfolio/${works[prevIndex].id}`;
        return {
            params: { id: painting.id },
            props: { painting, next, previous },
        };
    });
}
// 2. For your template, you can get the entry directly from the prop
const { painting, next, previous } = Astro.props;
let permalink = 'https://dan-murray-portfolio.netlify.com/';
const year = new Date(painting.data.year).getFullYear().toString();
---

<Page title={painting.data.title} description="" {permalink}>
    <style slot="head-slot">
        img {
            max-height: 100vh;
            max-width: 50%;
            margin: auto 0;
        }
    </style>
    <Image
        inferSize={true}
        src={painting.data.image}
        alt={painting.data.alt}
        priority={true}
        background="blurhash"
        fit="contain"
        layout="full-width"
        class="w-full md:w-1/2"
        widths={[200, 300, 400]}
        sizes="(max-width: 399px) 200px, (min-width: 400px) 300px, (min-width: 800px) 400px"
        slot="left-side"
    />
    <ImageCaption
        title={painting.data.title}
        medium={painting.data.medium}
        Dimensions={painting.data.Dimensions}
        year={year}
        links={{
            previous,
            next,
        }}
    />
</Page>
